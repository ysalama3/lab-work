# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.168900382762, 0.168900382762,0.168900382762,0.168900382762,0.168900382762,0.0535885954668,0.0444878956167,0.0282031788308,0.0315240604287,0.0371989551911,0.0371989551911,0.0371989551911,0.0422988649318,0.0422988649318,0.0422988649318,0.0371989551911,0.0479115250954,0.0587633538859,0.0792904709068,0.09189158142,0.0835790880837,0.09189158142,0.0942114262235,0.09189158142,0.0942114262235,0.09189158142,0.09189158142,0.09189158142,0.09189158142,0.09189158142,0.0942114262235,0.0975241431669,0.107257555059,0.137626436227,0.152485846723,0.152485846723,0.135335116563,0.137626436227,0.137626436227,0.137069510621,0.132360863909,0.137069510621,0.137069510621,0.135335116563,0.135335116563,0.135335116563,0.132360863909,0.131236546776,0.131236546776,0.131236546776)
L_hpd_M95=c(0.348065175959, 0.348065175959,0.348065175959,0.348065175959,0.361426856849,0.311093901133,0.262004043667,0.136221356768,0.137817492479,0.14007028826,0.137817492479,0.137817492479,0.14007028826,0.14007028826,0.14007028826,0.14007028826,0.172801692821,0.192604298844,0.197911838945,0.207176399644,0.197911838945,0.202960375274,0.204811868669,0.20961576988,0.216332861055,0.21987171566,0.21987171566,0.220083120418,0.220083120418,0.220083120418,0.274445351931,0.365224237872,0.418986139813,0.432025962913,0.451475425803,0.452438095823,0.438558756774,0.424688302733,0.424688302733,0.424688302733,0.418986139813,0.424688302733,0.424688302733,0.424688302733,0.424688302733,0.424688302733,0.424688302733,0.424688302733,0.424688302733,0.424688302733)
M_hpd_m95=c(0.894241848517, 0.894241848517,0.086947962208,0.086947962208,0.086947962208,0.086947962208,0.086947962208,0.0890628243245,0.0890628243245,0.089537889378,0.0915107889639,0.0915107889639,0.0915107889639,0.0890628243245,0.0890628243245,0.0890628243245,0.0834181877758,0.0834181877758,0.0834181877758,0.0890628243245,0.0890628243245,0.0890628243245,0.0890628243245,0.0890628243245,0.0890628243245,0.0890628243245,0.0890628243245,0.0890628243245,0.0792680441963,0.066412518317,0.0647295661399,0.0524775080333,0.0485643812035,0.0485643812035,0.048233351642,0.048233351642,0.0465442754755,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138,0.0441272900138)
M_hpd_M95=c(1.53146605963, 1.53146605963,0.143347434417,0.143347434417,0.143347434417,0.143347434417,0.143347434417,0.143347434417,0.133909373226,0.133909373226,0.133909373226,0.133909373226,0.133909373226,0.131631833865,0.131631833865,0.132358467323,0.124739949133,0.124739949133,0.124739949133,0.131631833865,0.131631833865,0.131631833865,0.131631833865,0.131631833865,0.131631833865,0.131631833865,0.131631833865,0.132358467323,0.137038809145,0.133909373226,0.133909373226,0.133909373226,0.132517427762,0.132517427762,0.132517427762,0.133909373226,0.133909373226,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762,0.132517427762)
R_hpd_m95=c(-1.25575423042, -1.25575423042,0.0680056994994,0.0680056994994,0.0315298932194,-0.0584884221436,-0.0788498472575,-0.0959413289288,-0.0788498472575,-0.082107136834,-0.0774449945594,-0.0774449945594,-0.0739246934,-0.0739246934,-0.0739246934,-0.0843706416431,-0.0680881663667,-0.0526026222794,-0.024423876679,-0.024423876679,-0.024423876679,-0.024423876679,-0.024423876679,-0.024423876679,-0.024423876679,-0.0320836548592,-0.0320836548592,-0.024423876679,-0.024423876679,-0.024423876679,-0.024423876679,-0.024423876679,0.0233945066168,0.0439573161087,0.0439573161087,0.0439573161087,0.0337888915358,0.0245446962347,0.0245446962347,0.0245446962347,0.0233945066168,0.024007177897,0.024007177897,0.024007177897,0.024007177897,0.024007177897,0.0233945066168,0.0191712139022,0.0191712139022,0.0191712139022)
R_hpd_M95=c(-0.603570625824, -0.603570625824,0.248769984725,0.248769984725,0.234285310251,0.22796300101,0.158399816051,0.0316826040445,0.0316826040445,0.0316826040445,0.0316826040445,0.0316826040445,0.0316826040445,0.0316826040445,0.0316826040445,0.0316826040445,0.0654681711229,0.0957220630449,0.106607500788,0.094262957569,0.0933226789125,0.0957220630449,0.0957220630449,0.11016270887,0.11016270887,0.117003013083,0.117003013083,0.126347113264,0.126815614709,0.126815614709,0.193555017685,0.270024228398,0.334392116053,0.343605580181,0.343605580181,0.348941513105,0.348941513105,0.344043753461,0.344043753461,0.344043753461,0.340597400629,0.344043753461,0.344043753461,0.344043753461,0.344043753461,0.344043753461,0.344043753461,0.344043753461,0.344043753461,0.344043753461)
L_mean=c(0.265348698622, 0.265348698622,0.265348698622,0.265348698622,0.262286456113,0.200248493418,0.0985959810087,0.0844494572016,0.0842337492569,0.0845424595386,0.0836858800223,0.0837343037512,0.0837109522065,0.0837109522065,0.0839268893352,0.0855952202892,0.103719260616,0.132938000047,0.140625091282,0.143205523094,0.144745932754,0.146905903086,0.148462439228,0.153038177013,0.153902406093,0.155694918582,0.155694918582,0.155748705321,0.156323701274,0.15631085181,0.166991476156,0.220439106163,0.271609443783,0.287241787702,0.291214819265,0.291664842381,0.289545675232,0.28219121036,0.281172863785,0.279826555299,0.280522662689,0.28114769405,0.281831751069,0.28173194087,0.285019041106,0.285910514676,0.287112527022,0.288556857269,0.288556857269,0.288556857269)
M_mean=c(1.19940205607, 1.19940205607,0.116099074191,0.116099074191,0.116099074191,0.115988633844,0.115900064757,0.115515389277,0.113510488092,0.113236650166,0.112549439147,0.112549439147,0.112549439147,0.112465204329,0.112465204329,0.112351144311,0.11219050887,0.11219050887,0.11219050887,0.112420151796,0.112420151796,0.112420151796,0.112420151796,0.112420151796,0.112420151796,0.112420151796,0.112420151796,0.112054672145,0.109985292241,0.109480268966,0.109071954298,0.107345860668,0.106187280437,0.105647889104,0.104716902897,0.104195150375,0.1036066827,0.103054334647,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728,0.103045057728)
R_mean=c(-0.934053357443, -0.934053357443,0.149249624431,0.149249624431,0.146187381922,0.0842598595742,-0.0173040837486,-0.0310659320755,-0.0292767388349,-0.0286941906277,-0.0288635591245,-0.0288151353955,-0.0288384869402,-0.0287542521221,-0.0285383149934,-0.0267559240219,-0.00847124825396,0.0207474911763,0.0284345824115,0.0307853712981,0.0323257809574,0.0344857512895,0.0360422874323,0.0406180252168,0.0414822542965,0.0432747667858,0.0432747667858,0.0436940331756,0.0463384090338,0.046830582844,0.0579195218581,0.113093245495,0.165422163346,0.181593898599,0.186497916367,0.187469692006,0.185938992532,0.179136875713,0.178127806056,0.17678149757,0.177477604961,0.178102636322,0.178786693341,0.178686883142,0.181973983378,0.182865456948,0.184067469294,0.18551179954,0.18551179954,0.18551179954)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.497681905405), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.6846126656), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.38132965346, 0.383835664415), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()